
<md-toolbar color="primary">
<button md-button [routerLink]="['/recordlist/'+type]" mdTooltip="{{'record.edit.back' | translate }}"><md-icon>arrow_back</md-icon></button>
{{'record.edit.title' | translate }}
<button md-button (click)="save()"  mdTooltip="{{'record.edit.save' | translate }}"><md-icon>save</md-icon></button>
<button md-button *ngIf="!newrecord && hasAdminRole" (click)="preview()"> <md-icon>open_in_new</md-icon></button>
<button md-button *ngIf="!newrecord" (click)="openConfirmDialog()" mdTooltip="{{'record.edit.delete' | translate }}"> <md-icon>delete</md-icon></button>

</md-toolbar>


<div class="container">
  <div>
    <div *ngIf='responsemessage && responsemessage.error' class='error-label-message'>
      <md-icon>cloud_off</md-icon>  {{responsemessage.error}}
    </div>
    <div *ngIf='responsemessage && !responsemessage.error' class='success-label-message'>
      <md-icon mdTooltip='{{responsemessage.savedate}}'>cloud_done</md-icon> {{responsemessage.since}}
    </div>

    <div *ngIf="current">


      <div *ngFor="let property of properties">

        <!-- multiline text edit -->

        <md-input-container *ngIf="property.editor === 'text'" class="full-width-textarea">
          <textarea mdInput placeholder="{{'field.label.' + property.name | translate }}" rows="10" cols="" [(ngModel)]="current[property.name]" name="{{property.name}}">{{current[property.name]}}</textarea>
        </md-input-container>


        <!-- single line text edit -->
        <div *ngIf="property.name === 'id'">
          <md-input-container class="full-width-input" *ngIf="property.editor === 'line'">
            <input readonly mdInput placeholder="{{'field.label.' + property.name | translate }}" [(ngModel)]="current[property.name]" name="{{property.name}}" type="text">
          </md-input-container>
        </div>
        <div *ngIf="property.name === 'title'">
          <md-input-container class="full-width-input" *ngIf="property.editor === 'line'">
            <input (keypress)="generateId()" (change)="generateId()" mdInput placeholder="{{'field.label.' + property.name | translate }}" [(ngModel)]="current[property.name]" name="{{property.name}}" type="text">
          </md-input-container>
        </div>

        <div *ngIf="property.name !== 'id' && property.name !== 'title'">
          <md-input-container class="full-width-input" *ngIf="property.editor === 'line'">
            <input mdInput placeholder="{{'field.label.' + property.name | translate }}" [(ngModel)]="current[property.name]" name="{{property.name}}" type="text">
          </md-input-container>
        </div>

        <div *ngIf="property.editor === 'date'">
          <md-input-container  *ngIf="property.editor === 'date'">
            <input mdInput placeholder="{{'field.label.' + property.name | translate }}" [(ngModel)]="current[property.name]" name="{{property.name}}" type="date">
          </md-input-container>
        </div>

        <!-- choice list -->
        <div *ngIf="property.editor === 'choice'">
          <md-select placeholder="{{'field.label.' + property.name | translate }}" [(ngModel)]="current[property.name]" name="{{property.name}}">
            <!-- list of choices from metadata -->
            <md-option *ngFor="let choice of property.choices" [value]="choice">{{ choice }}</md-option>
          </md-select>

        </div>



        <div *ngIf="property.editor === 'imagelist' && property.name === 'images'" class="list-container">
          <app-editlinks [type]='type' [current]='current'  [attachments]='current.images' [title]='"record.edit.images"' ></app-editlinks>
        </div>


        <div *ngIf="property.editor === 'attachmentlist' && property.name === 'attachments'" class="list-container">

          <app-editlinks [type]='type' [current]='current'  [attachments]='current.attachments' [title]='"record.edit.attachments"' ></app-editlinks>

        </div><!-- attachments -->



        <div *ngIf="!newrecord && property.editor === 'medialist' && property.name === 'media'" class="list-container">
          <app-editmedia [type]='type' [current]='current'  [attachments]='current.media' [title]='"record.edit.media"' ></app-editmedia>

        </div><!-- list-container -->


      </div><!-- properties -->






    </div><!-- current -->


  </div>
</div>
